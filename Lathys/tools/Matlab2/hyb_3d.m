%%%%%%%%%%%%%%%%%%%%%%%%%%%
% cw_read_MPI_netCDF.m
%--------------------------
% This program reads the cw files
% of the simulation written in
% netdcf format.
% It plots  : density, speeed,
% magnetic field, electric field
%--------------------------
% R. Modolo, M. Mancini
% LATMOS / UVSQ
% Quartier des Garennes
% 11 bd d'Alembert
% 78280 Guyancourt
% ronan.modolo@latmos.ipsl.fr


clear all;
 
scrsz = get(0,'ScreenSize');
h_f1 = figure('Position',scrsz,'Name',' ',...
    'Numbertitle','off');

x0=scrsz(1)+10.;
y0=scrsz(2)+2.*scrsz(4)/3.-40.;
x1=scrsz(3);
y1=scrsz(4);

q0 = uicontrol('Style','frame',...
    'pos',[x0 y0+60 250 140]);
q1 = uicontrol('Style','frame',...
    'pos',[x0+270. y0+60 250 140]);
q2 = uicontrol('Style','frame',...
    'pos',[x0+540. y0+60 250 140]);
q3 = uicontrol('Style','frame',...
    'pos',[x0+810. y0+60 150 140]);

 h = uibuttongroup('visible','off','Position',[0 0 1 1]);

t01 = uicontrol('Style','Text','String','Directory:',...
    'pos',[x0+20 y0+150 75 30],'parent',h,'HandleVisibility','off');
t02 = uicontrol('Style','Edit','String','/home/seb/Bureau/Hybrid/CDF/',...
    'pos',[x0+100 y0+163 120 20],'parent',h,'HandleVisibility','off');
t03 = uicontrol('Style','Text','String','Date:',...
    'pos',[x0+20 y0+110 75 30],'parent',h,'HandleVisibility','off');
t04 = uicontrol('Style','Edit','String','',...
    'pos',[x0+100 y0+123 20 20],'parent',h,'HandleVisibility','off');
t05 = uicontrol('Style','Edit','String','',...
    'pos',[x0+150 y0+123 20 20],'parent',h,'HandleVisibility','off');
t06 = uicontrol('Style','Edit','String','',...
    'pos',[x0+200 y0+123 20 20],'parent',h,'HandleVisibility','off');
list_time={''};
t07 = uicontrol('Style','Text','String','Time:',...
    'pos',[x0+20 y0+70 75 30],'parent',h,'HandleVisibility','off');
u01 = uicontrol('Style','popup','String',list_time,...
    'pos',[x0+100 y0+83 75 20],'parent',h,'HandleVisibility','off');

t11 = uicontrol('Style','Text','String','Planet:',...
    'pos',[x0+290 y0+150 75 30],'parent',h,'HandleVisibility','off');
t12 = uicontrol('Style','Text','String','',...
    'pos',[x0+370 y0+150 75 30],'parent',h,'HandleVisibility','off');
t13 = uicontrol('Style','Text','String','dx:',...
    'pos',[x0+275 y0+110 35 30],'parent',h,'HandleVisibility','off');
t14 = uicontrol('Style','Text','String','',...
    'pos',[x0+311 y0+110 40 30],'parent',h,'HandleVisibility','off');
t15 = uicontrol('Style','Text','String','dy:',...
    'pos',[x0+357 y0+110 35 30],'parent',h,'HandleVisibility','off');
t16 = uicontrol('Style','Text','String','',...
    'pos',[x0+393 y0+110 40 30],'parent',h,'HandleVisibility','off');
t17 = uicontrol('Style','Text','String','dz:',...
    'pos',[x0+439 y0+110 35 30],'parent',h,'HandleVisibility','off');
t18 = uicontrol('Style','Text','String','',...
    'pos',[x0+475 y0+110 40 30],'parent',h,'HandleVisibility','off');
t19 = uicontrol('Style','Text','String','#Spe:',...
    'pos',[x0+275 y0+70 40 30],'parent',h,'HandleVisibility','off');
t110 = uicontrol('Style','Text','String','',...
    'pos',[x0+316 y0+70 35 30],'parent',h,'HandleVisibility','off');
t111 = uicontrol('Style','Text','String','#Neu:',...
    'pos',[x0+357 y0+70 40 30],'parent',h,'HandleVisibility','off');
t112 = uicontrol('Style','Text','String','',...
    'pos',[x0+398 y0+70 35 30],'parent',h,'HandleVisibility','off');
t113 = uicontrol('Style','Text','String','#Prod:',...
    'pos',[x0+439 y0+70 40 30],'parent',h,'HandleVisibility','off');
t114 = uicontrol('Style','Text','String','',...
    'pos',[x0+480 y0+70 35 30],'parent',h,'HandleVisibility','off');

% Create three radio buttons in the button group.
list_field={'' 'E' 'B' 'P' 'J' 'v' 'n' 'T' 'prod'};
t21 = uicontrol('Style','Text','String','Field:',...
    'pos',[x0+560 y0+150 85 30],'parent',h,'HandleVisibility','off');
u21 = uicontrol('Style','popup','String',list_field,...
    'pos',[x0+650 y0+163 75 20],'parent',h,'HandleVisibility','off'); 
t22 = uicontrol('Style','Text','String','Component:',...
    'pos',[x0+560 y0+110 85 30],'parent',h,'HandleVisibility','off');
list_compo={''};
what_field=get(u21,'Value');
if ((what_field == 2) | (what_field == '5') | (what_field == '6'))
        list_compo={'x' 'y' 'z' '//' '_|_' 'total'};
end
if ((what_field == 3))
        list_compo={'x' 'y' 'z' 'total'};
end
if ((what_field == 1) | (what_field == 4))
        list_compo={''};
end
if ((what_field == '7'))
        list_compo={'' 'electrons'};
end
if ((what_field == '8'))
        list_compo={'' 'electrons'};
end
if ((what_field == '9'))
        list_compo={''};
end
u22 = uicontrol('Style','popup','String',list_compo,...
    'pos',[x0+650 y0+123 75 20],'parent',h,'HandleVisibility','off');
t23 = uicontrol('Style','Text','String','Log:',...
    'pos',[x0+560 y0+70 85 30],'parent',h,'HandleVisibility','off');
u23 = uicontrol('Style','Checkbox','String','',...
    'pos',[x0+650 y0+83 75 20],'parent',h,'HandleVisibility','off'); 


t31=uicontrol('Style','text',...
        'Position',[x0+820 y0+150 40 30],...
        'String','Color');

u31=uicontrol('Style', 'popup',...
           'String', 'jet|hsv|hot|cool|gray',...
           'Position', [x0+865 y0+163 60 20],...
           'Callback', @setmap);       % Popup function handle callback
                                       % Implemented as a subfunction
c_limit=[0 1];   
 t32=uicontrol('Style','text',...
        'Position',[x0+820 y0+110 40 30],...
        'String','Min:');
 t33=uicontrol('Style','edit',...
        'Position',[x0+865 y0+123 60 20],...
        'String',c_limit(1),...
        'Callback', @setlimmin);    
 t34=uicontrol('Style','text',...
        'Position',[x0+820 y0+70 40 30],...
        'String','Max:');
 t35=uicontrol('Style','edit',...
        'Position',[x0+865 y0+83 60 20],...
        'String',c_limit(2),...
        'Callback', @setlimmax); 
    
 u41=uicontrol('Style', 'popup',...
           'String', 'electrons','Position', [x0-1000 y0-1000 1 1])
list_obj={t01 t02 t03 t04 t05 t06 t07 u01 t11 t12 t13 t14 t15 t16 t17 t18 t19 t110 t111 t112 t113 t114 t21 u21 t22 u22 t23 u23 t31 u31 t32 t33 t34 t35 u41};

set(u21,'Callback',{@setfield list_obj});
set(u01,'Callback',{@plot_figs list_obj});
set(u22,'Callback',{@plot_figs list_obj});
set(u23,'Callback',{@plot_figs list_obj});
set(t02,'Callback',{@setfile list_obj});
set(t04,'Callback',{@setfile list_obj});
set(t05,'Callback',{@setfile list_obj});
set(t06,'Callback',{@setfile list_obj});
set(h,'SelectedObject',[]);  % No selection
set(h,'Visible','on');
